#lang racket

;; * ----------- üß≠ –ú–æ–¥–µ–ª—å: –ö–ª—é—á–µ–≤—ã–µ —É–±–µ–∂–¥–µ–Ω–∏—è (core-belief-reaction)

;; üß≠ –ú–æ–¥–µ–ª—å: –∫–∞–∫ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –∞–≥–µ–Ω—Ç, –µ—Å–ª–∏ –Ω–µ–∑–Ω–∞–Ω–∏–µ –∫–∞—Å–∞–µ—Ç—Å—è –∫–ª—é—á–µ–≤–æ–≥–æ —É–±–µ–∂–¥–µ–Ω–∏—è

;; –í—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
;; - —Å–≤—è–∑–∞–Ω–∞-—Å-—É–±–µ–∂–¥–µ–Ω–∏—è–º–∏?: —Ç–µ–º–∞ –∫–∞—Å–∞–µ—Ç—Å—è —è–¥—Ä–∞ —Å–∞–º–æ–∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏
;; - —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å?: –≤—ã–∑—ã–≤–∞–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ
;; - –∏–Ω—Ç–µ—Ä–µ—Å?: –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –º–æ—Ç–∏–≤–∞—Ü–∏—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å

(define (–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å-—Ä–µ–∂–∏–º-–ø–æ–≤–µ–¥–µ–Ω–∏—è —Å–≤—è–∑–∞–Ω–∞-—Å-—É–±–µ–∂–¥–µ–Ω–∏—è–º–∏? —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å? –∏–Ω—Ç–µ—Ä–µ—Å?)
  (cond
    ;; –£–±–µ–∂–¥–µ–Ω–∏–µ + —Ç—Ä–µ–≤–æ–≥–∞ + –Ω–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å–∞ ‚Üí –∑–∞—â–∏—Ç–∞ –¥–æ–≥–º–æ–π
    [(and —Å–≤—è–∑–∞–Ω–∞-—Å-—É–±–µ–∂–¥–µ–Ω–∏—è–º–∏? —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å? (not –∏–Ω—Ç–µ—Ä–µ—Å?))
     '–∑–∞–º–µ—â–µ–Ω–∏–µ-–ø—É—Å—Ç–æ—Ç—ã-–¥–æ–≥–º–∞—Ç–∏—á–µ—Å–∫–æ–π-–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π]

    ;; –£–±–µ–∂–¥–µ–Ω–∏–µ + —Ç—Ä–µ–≤–æ–≥–∞ + –∏–Ω—Ç–µ—Ä–µ—Å ‚Üí –ø—Ä–µ–¥–≤–∑—è—Ç–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ
    [(and —Å–≤—è–∑–∞–Ω–∞-—Å-—É–±–µ–∂–¥–µ–Ω–∏—è–º–∏? —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å? –∏–Ω—Ç–µ—Ä–µ—Å?)
     '–ø—Ä–µ–¥–≤–∑—è—Ç–æ–µ-–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ]

    ;; –£–±–µ–∂–¥–µ–Ω–∏–µ + –Ω–µ—Ç —Ç—Ä–µ–≤–æ–≥–∏ ‚Üí –≤—ã—Ç–µ—Å–Ω–µ–Ω–∏–µ
    [(and —Å–≤—è–∑–∞–Ω–∞-—Å-—É–±–µ–∂–¥–µ–Ω–∏—è–º–∏? (not —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å?))
     '–≤—ã—Ç–µ—Å–Ω–µ–Ω–∏–µ]

    ;; –£–±–µ–∂–¥–µ–Ω–∏–µ –Ω–µ –∑–∞—Ç—Ä–æ–Ω—É—Ç–æ ‚Üí —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
    [else
     '–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ-–ø–æ–≤–µ–¥–µ–Ω–∏–µ]))

;; –ü–æ–±–æ—á–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ —Ä–µ–∂–∏–º—É
(define (–ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π-–≤—ã–≤–æ–¥ —Ä–µ–∂–∏–º)
  (cond
    [(eq? —Ä–µ–∂–∏–º '–∑–∞—â–∏—Ç–∞-–¥–æ–≥–º–æ–π)
     '–∑–∞–º–µ—â–µ–Ω–∏–µ-–ø—É—Å—Ç–æ—Ç—ã-–¥–æ–≥–º–∞—Ç–∏—á–µ—Å–∫–æ–π-–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π]

    [(eq? —Ä–µ–∂–∏–º '–ø—Ä–µ–¥–≤–∑—è—Ç–æ–µ-–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ)
     '–∏—Å–∫–∞–∂—ë–Ω–Ω–æ–µ-–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ]

    [(eq? —Ä–µ–∂–∏–º '–≤—ã—Ç–µ—Å–Ω–µ–Ω–∏–µ)
     '—Å–Ω–∏–∂–µ–Ω–∏–µ-—Ñ–æ–∫—É—Å–∞-–Ω–∞-—Ç–µ–º–µ]

    [(eq? —Ä–µ–∂–∏–º '–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ-–ø–æ–≤–µ–¥–µ–Ω–∏–µ)
     '–ø—Ä–∏–º–µ–Ω–∏—Ç—å-–æ–±—â—É—é-—ç–≤—Ä–∏—Å—Ç–∏–∫—É]

    [else
     '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è-—Ä–µ–∞–∫—Ü–∏—è]))

;; –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
(define (–æ–±—Ä–∞–±–æ—Ç–∫–∞-–ø—Ä–∏-—É–±–µ–∂–¥–µ–Ω–∏—è—Ö —Å–≤—è–∑–∞–Ω–∞-—Å-—É–±–µ–∂–¥–µ–Ω–∏—è–º–∏? —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å? –∏–Ω—Ç–µ—Ä–µ—Å?)
  (let* ([—Ä–µ–∂–∏–º (–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å-—Ä–µ–∂–∏–º-–ø–æ–≤–µ–¥–µ–Ω–∏—è —Å–≤—è–∑–∞–Ω–∞-—Å-—É–±–µ–∂–¥–µ–Ω–∏—è–º–∏? —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å? –∏–Ω—Ç–µ—Ä–µ—Å?)])
    (–ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π-–≤—ã–≤–æ–¥ —Ä–µ–∂–∏–º)))


;; üîç –ü—Ä–∏–º–µ—Ä—ã –≤—ã–∑–æ–≤–∞:

;; –°–∏–ª—å–Ω–∞—è —Ç—Ä–µ–≤–æ–≥–∞, –Ω–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å–∞, —Ç–µ–º–∞ –≤–∞–∂–Ω–∞ ‚Üí –∑–∞—â–∏—Ç–∞
(–æ–±—Ä–∞–±–æ—Ç–∫–∞-–ø—Ä–∏-—É–±–µ–∂–¥–µ–Ω–∏—è—Ö #t #t #f)  ; ‚Üí '–∑–∞–º–µ—â–µ–Ω–∏–µ-–ø—É—Å—Ç–æ—Ç—ã-–¥–æ–≥–º–∞—Ç–∏—á–µ—Å–∫–æ–π-–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π

;; –ï—Å—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å, –Ω–æ —Ç–µ–º–∞ —Ç—Ä–µ–≤–æ–∂–∏—Ç ‚Üí –ø—Ä–µ–¥–≤–∑—è—Ç–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ
(–æ–±—Ä–∞–±–æ—Ç–∫–∞-–ø—Ä–∏-—É–±–µ–∂–¥–µ–Ω–∏—è—Ö #t #t #t)  ; ‚Üí '–∏—Å–∫–∞–∂—ë–Ω–Ω–æ–µ-–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ

;; –¢–µ–º–∞ —Å–≤—è–∑–∞–Ω–∞ —Å —É–±–µ–∂–¥–µ–Ω–∏–µ–º, –Ω–æ –Ω–µ—Ç —Ç—Ä–µ–≤–æ–≥–∏ ‚Üí –≤—ã—Ç–µ—Å–Ω–µ–Ω–∏–µ
(–æ–±—Ä–∞–±–æ—Ç–∫–∞-–ø—Ä–∏-—É–±–µ–∂–¥–µ–Ω–∏—è—Ö #t #f #t)  ; ‚Üí '—Å–Ω–∏–∂–µ–Ω–∏–µ-—Ñ–æ–∫—É—Å–∞-–Ω–∞-—Ç–µ–º–µ

;; –¢–µ–º–∞ –Ω–µ –∫–∞—Å–∞–µ—Ç—Å—è —É–±–µ–∂–¥–µ–Ω–∏–π ‚Üí —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
(–æ–±—Ä–∞–±–æ—Ç–∫–∞-–ø—Ä–∏-—É–±–µ–∂–¥–µ–Ω–∏—è—Ö #f #t #t)  ; ‚Üí '–ø—Ä–∏–º–µ–Ω–∏—Ç—å-–æ–±—â—É—é-—ç–≤—Ä–∏—Å—Ç–∏–∫—É



