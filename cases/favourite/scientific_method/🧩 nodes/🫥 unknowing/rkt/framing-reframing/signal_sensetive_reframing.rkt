#lang racket

; Ð’Ð¾Ð¿Ñ€Ð¾Ñ:
; Ñ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾ Ð¿Ð¾Ð½Ð¸Ð¼Ð°ÑŽ Ñ‡Ñ‚Ð¾ ÐºÐ»ÑŽÑ‡ÐµÐ²Ð°Ñ Ð»Ð¾Ð³Ð¸ÐºÐ° need-reframe? Ð² Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð½Ð¾Ð¼ Ð±Ð°Ð»Ð°Ð½ÑÐµ Ð¿Ð¾ ÑÑƒÑ‚Ð¸

; ÐžÑ‚Ð²ÐµÑ‚:
; Ð”Ð°, Ñ‚Ñ‹ ÑÐ¾Ð²ÐµÑ€ÑˆÐµÐ½Ð½Ð¾ Ñ‚Ð¾Ñ‡Ð½Ð¾ Ð¿Ð¾Ð½ÑÐ»:
; Ð² Ð¾ÑÐ½Ð¾Ð²Ðµ need-reframe? Ð»ÐµÐ¶Ð¸Ñ‚ Ð±Ð°Ð»Ð°Ð½Ñ Ð¼ÐµÐ¶Ð´Ñƒ Ð¾Ñ‰ÑƒÑ‰ÐµÐ½Ð¸ÐµÐ¼ Â«Ñ€Ð°Ð¼ÐºÐ° Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚Â» Ð¸ ÑÐ¸Ð³Ð½Ð°Ð»Ð°Ð¼Ð¸, Ñ‡Ñ‚Ð¾ Ð¾Ð½Ð° Ð±Ð¾Ð»ÑŒÑˆÐµ Ð½Ðµ ÑÐ¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ÑÑ.

; â¸»

; ðŸ§  Ð¤Ð¾Ñ€Ð¼ÑƒÐ»Ð¸Ñ€ÑƒÐµÐ¼ Ñ‡Ñ‘Ñ‚ÐºÐ¾:

; need-reframe? â€” ÑÑ‚Ð¾ Ð½Ðµ Ð±Ð¸Ð½Ð°Ñ€Ð½Ñ‹Ð¹ Ñ‚Ñ€Ð¸Ð³Ð³ÐµÑ€,
; Ð° Ð¼ÐµÑ…Ð°Ð½Ð¸Ð·Ð¼, Ð¾Ñ†ÐµÐ½Ð¸Ð²Ð°ÑŽÑ‰Ð¸Ð¹ ÑƒÑÑ‚Ð¾Ð¹Ñ‡Ð¸Ð²Ð¾ÑÑ‚ÑŒ Ñ€Ð°Ð¼ÐºÐ¸ Ð¿Ð¾ Ñ‚Ñ€ÐµÐ¼ Ð¾ÑÑÐ¼:

; 	1.	ÐŸÐ¾ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ â€” ÑÐ¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ÑÑ Ð»Ð¸ Ñ€Ð°Ð¼ÐºÐ° Ñ Ñ‚ÐµÐ¼Ð¾Ð¹?
; 	2.	Ð˜ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ â€” Ð½Ð°ÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ñ‡Ð°ÑÑ‚Ð¾ Ð²Ð¾Ð·Ð½Ð¸ÐºÐ°ÑŽÑ‚ ÑÐ¸Ñ‚ÑƒÐ°Ñ†Ð¸Ð¸, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð½Ð°Ð´Ð¾ â€œÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ñ‚ÑŒâ€?
; 	3.	Ð¡Ð²ÐµÐ¶ÐµÑÑ‚ÑŒ Ð¼Ñ‹ÑˆÐ»ÐµÐ½Ð¸Ñ â€” Ñ€Ð¾Ð¶Ð´Ð°ÑŽÑ‚ÑÑ Ð»Ð¸ Ð½Ð¾Ð²Ñ‹Ðµ Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹?

; â¸»

; âš–ï¸ Ð¢Ð¾ ÐµÑÑ‚ÑŒ Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚:

; ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€	ÐšÐ¾Ð³Ð´Ð° Ð½Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ð¾	ÐšÐ¾Ð³Ð´Ð° ÑÐ¸Ð³Ð½Ð°Ð» Ðº Ñ€ÐµÑ„Ñ€ÐµÐ¹Ð¼Ñƒ
; Ð¿Ð¾ÐºÑ€Ñ‹Ð²Ð°ÐµÑ‚?	Ð”Ð° â†’ Ñ€Ð°Ð¼ÐºÐ° Ð¿Ñ€Ð¸Ð¼ÐµÐ½Ð¸Ð¼Ð°	ÐÐµÑ‚ â†’ Ñ€Ð°Ð¼ÐºÐ° ÑÐ»Ð¾Ð¼Ð°Ð½Ð°
; Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ	ÐœÐ°Ð»Ð¾ â†’ Ñ€Ð°Ð¼ÐºÐ° Ð³Ð¸Ð±ÐºÐ°Ñ	ÐœÐ½Ð¾Ð³Ð¾ â†’ Ñ€Ð°Ð¼ÐºÐ° Ð½Ð°Ñ‡Ð¸Ð½Ð°ÐµÑ‚ Ð»Ð¾Ð¼Ð°Ñ‚ÑŒÑÑ
; Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð²	Ð•ÑÑ‚ÑŒ â†’ Ð¼Ñ‹ÑˆÐ»ÐµÐ½Ð¸Ðµ Ð¶Ð¸Ð²Ð¾Ðµ	ÐÐµÑ‚ â†’ Ð·Ð°ÑÑ‚Ð¾Ð¹, Ð¿Ñ€Ð¸Ð²Ñ‹Ñ‡ÐºÐ°, ÑÑ‚Ð°Ð·Ð¸Ñ

; ðŸ” Ð˜ ÐºÐ¾Ð³Ð´Ð° Ð±Ð°Ð»Ð°Ð½Ñ Ð½Ð°Ñ€ÑƒÑˆÐ°ÐµÑ‚ÑÑ, Ð¼Ñ‹ Ð½Ðµ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð¼ÐµÐ½ÑÐµÐ¼ Ñ€Ð°Ð¼ÐºÑƒ,
; Ð° Ð½Ð°Ñ‡Ð¸Ð½Ð°ÐµÐ¼ ÑÐ¾Ð¼Ð½ÐµÐ²Ð°Ñ‚ÑŒÑÑ Ð² Ñ‚Ð¾Ð¼, Ñ‡Ñ‚Ð¾ Ð¾Ð½Ð° â€œÐ¸ÑÑ‚Ð¸Ð½Ð½Ð° Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽâ€.




; Ð¢Ñ‹ Ñ…Ð¾Ñ‡ÐµÑˆÑŒ Ð½Ðµ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Â«Ñ€ÐµÑ„Ñ€ÐµÐ¹Ð¼Ð¸Ð½Ð³ â€” Ð´Ð°/Ð½ÐµÑ‚Â», Ð° Ð¼Ð¾Ð´ÐµÐ»ÑŒ, Ñ‡ÑƒÐ²ÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½ÑƒÑŽ Ðº Ñ‚Ð¸Ð¿Ñƒ ÑÐ¸Ð³Ð½Ð°Ð»Ð°, Ñ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒÑŽ:
; 	â€¢	Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð°Ñ‚ÑŒ, Ð¿Ð¾Ñ‡ÐµÐ¼Ñƒ Ñ€Ð°Ð¼ÐºÐ° Ð±Ð¾Ð»ÑŒÑˆÐµ Ð½Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚;
; 	â€¢	Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ ÑÑ‚Ð¾ ÐºÐ°Ðº Ð¾ÑÐ½Ð¾Ð²Ñƒ Ð´Ð»Ñ Ñ€Ð°Ð·Ð½Ñ‹Ñ… ÑÑ‚Ñ€Ð°Ñ‚ÐµÐ³Ð¸Ð¹ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð°: Ð¼ÑÐ³ÐºÐ¸Ð¹, ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹, Ñ‡ÐµÑ€ÐµÐ· ÐºÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚ Ð¸ Ñ‚.Ð´.


; â¸»

; âœ… 1. Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð¸Ñ€ÑƒÐµÐ¼: Ñ‚Ñ€Ð¸ Ñ‚Ð¸Ð¿Ð° ÑÐ¸Ð³Ð½Ð°Ð»Ð¾Ð²

;; Ð¢Ð¸Ð¿ 1: Ð²Ð½ÑƒÑ‚Ñ€ÐµÐ½Ð½ÑÑ Ð³Ð»Ð°Ð´ÐºÐ¾ÑÑ‚ÑŒ â€” Ð¿Ñ€Ð¸Ð·Ð½Ð°Ðº ÑÑ‚Ð°Ð³Ð½Ð°Ñ†Ð¸Ð¸
(define Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð²-1 0) ; Ð½ÐµÑ‚ Ð½Ð¾Ð²Ñ‹Ñ… Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð²
(define Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÑÐµÐ¼Ð¾ÑÑ‚ÑŒ #t) ; Ð²ÑÑ‘ Ð·Ð²ÑƒÑ‡Ð¸Ñ‚ Ð·Ð½Ð°ÐºÐ¾Ð¼Ð¾
(define ÐºÑ€ÑƒÑ‚Ð¸Ñ‚ÑÑ-Ð¿Ð¾-ÐºÑ€ÑƒÐ³Ñƒ #t)

;; Ð¢Ð¸Ð¿ 2: Ð¾Ñ‚ÐºÐ°Ð· Ð¼Ð¾Ð´ÐµÐ»Ð¸ â€” ÑÐ±Ð¾Ð¸ Ð² Ð¾Ð±ÑŠÑÑÐ½ÐµÐ½Ð¸Ð¸
(define Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ-2 3)
(define Ñ€Ð°Ñ†Ð¸Ð¾Ð½Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ #t)
(define Ð¿ÐµÑ€ÐµÐ½Ð¾Ñ-Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼ #t)

;; Ð¢Ð¸Ð¿ 3: ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚ Ñ Ð´Ñ€ÑƒÐ³Ð¸Ð¼ Ð²Ð¸Ð´ÐµÐ½Ð¸ÐµÐ¼ â€” ÐºÐ¾Ð³Ð½Ð¸Ñ‚Ð¸Ð²Ð½Ð¾Ðµ Ñ‚Ñ€ÐµÐ½Ð¸Ðµ
(define Ð½ÐµÑƒÑŽÑ‚Ð½Ð¾ÑÑ‚ÑŒ #t)
(define ÑÑ„Ñ„ÐµÐºÑ‚-ÑƒÐ·Ð½Ð°Ð²Ð°Ð½Ð¸Ñ #t)
(define Ð·Ð°Ñ‰Ð¸Ñ‚Ð°-Ñ€Ð°Ð¼ÐºÐ¸ #t)


;  âœ… 2. Ð¢Ñ€Ð¸ Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸


;; ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð° Ð²Ð½ÑƒÑ‚Ñ€ÐµÐ½Ð½ÑŽÑŽ Ð³Ð»Ð°Ð´ÐºÐ¾ÑÑ‚ÑŒ
(define (reframe-Ð³Ð»Ð°Ð´ÐºÐ¾ÑÑ‚ÑŒ? Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð² Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÑÐµÑ‚ÑÑ ÐºÑ€ÑƒÐ³)
  (if (and (zero? Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð²) Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÑÐµÑ‚ÑÑ ÐºÑ€ÑƒÐ³)
      #t
      #f))


;; ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð° Ð¾Ñ‚ÐºÐ°Ð· Ð¼Ð¾Ð´ÐµÐ»Ð¸
(define (reframe-Ð¾Ñ‚ÐºÐ°Ð·? Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ñ€Ð°Ñ†Ð¸Ð¾Ð½Ð°Ð»Ð¸Ð· Ð¿ÐµÑ€ÐµÐ½Ð¾Ñ)
  (if (or (> Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ 2) Ñ€Ð°Ñ†Ð¸Ð¾Ð½Ð°Ð»Ð¸Ð· Ð¿ÐµÑ€ÐµÐ½Ð¾Ñ)
      #t
      #f))


;; ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð° ÐºÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚ Ñ Ð°Ð»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð¾Ð¹
(define (reframe-ÐºÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚? Ð½ÐµÑƒÑŽÑ‚Ð½Ð¾ ÑƒÐ·Ð½Ð°Ð²Ð°Ð½Ð¸Ðµ Ð·Ð°Ñ‰Ð¸Ñ‚Ð°)
  (if (or Ð½ÐµÑƒÑŽÑ‚Ð½Ð¾ ÑƒÐ·Ð½Ð°Ð²Ð°Ð½Ð¸Ðµ Ð·Ð°Ñ‰Ð¸Ñ‚Ð°)
      #t
      #f))



;  âœ… 2. Ð¢Ñ€Ð¸ Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸

(define (need-reframe? Ñ‚Ð¸Ð¿)
  (cond
    [(equal? Ñ‚Ð¸Ð¿ 'Ð³Ð»Ð°Ð´ÐºÐ¾ÑÑ‚ÑŒ)
     (reframe-Ð³Ð»Ð°Ð´ÐºÐ¾ÑÑ‚ÑŒ? Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð²-1 Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÑÐµÐ¼Ð¾ÑÑ‚ÑŒ ÐºÑ€ÑƒÑ‚Ð¸Ñ‚ÑÑ-Ð¿Ð¾-ÐºÑ€ÑƒÐ³Ñƒ)]
    
    [(equal? Ñ‚Ð¸Ð¿ 'Ð¾Ñ‚ÐºÐ°Ð·)
     (reframe-Ð¾Ñ‚ÐºÐ°Ð·? Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ-2 Ñ€Ð°Ñ†Ð¸Ð¾Ð½Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð¿ÐµÑ€ÐµÐ½Ð¾Ñ-Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼)]

    [(equal? Ñ‚Ð¸Ð¿ 'ÐºÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚)
     (reframe-ÐºÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚? Ð½ÐµÑƒÑŽÑ‚Ð½Ð¾ÑÑ‚ÑŒ ÑÑ„Ñ„ÐµÐºÑ‚-ÑƒÐ·Ð½Ð°Ð²Ð°Ð½Ð¸Ñ Ð·Ð°Ñ‰Ð¸Ñ‚Ð°-Ñ€Ð°Ð¼ÐºÐ¸)]

    [else
     #f]))



; ðŸ§ª ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ Ð²Ñ‹Ð·Ð¾Ð²Ð°

(need-reframe? 'Ð³Ð»Ð°Ð´ÐºÐ¾ÑÑ‚ÑŒ)  ; => #t
(need-reframe? 'Ð¾Ñ‚ÐºÐ°Ð·)      ; => #t
(need-reframe? 'ÐºÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚)   ; => #t