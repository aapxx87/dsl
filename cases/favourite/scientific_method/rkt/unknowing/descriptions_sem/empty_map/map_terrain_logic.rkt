#lang racket

; * –ö–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –ø—É—Å—Ç–æ—Ç–∞ ‚Äî –±–µ–ª–æ–µ –ø—è—Ç–Ω–æ –Ω–∞ –∫–∞—Ä—Ç–µ –∑–Ω–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª–∏–±–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–æ, –ª–∏–±–æ –∑–∞–º–µ—â–µ–Ω–æ –∏–ª–ª—é–∑–∏–µ–π


; * –ú–æ–¥–µ–ª—å: –∫–∞–∫ —Ä–∞–∑—É–º —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –ø—É—Å—Ç–æ—Ç—É –≤ –∑–Ω–∞–Ω–∏–∏

;; –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è: –∫–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –±–µ–ª–æ–µ –ø—è—Ç–Ω–æ –Ω–∞ –∫–∞—Ä—Ç–µ –∑–Ω–∞–Ω–∏—è?

; –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

(define —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å #t)    ; –æ—â—É—â–µ–Ω–∏–µ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏ –≤—ã–∑—ã–≤–∞–µ—Ç —Ç—Ä–µ–≤–æ–≥—É
(define –∏–Ω—Ç–µ—Ä–µ—Å #f)         ; –µ—Å—Ç—å –ª–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –º–æ—Ç–∏–≤–∞—Ü–∏—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å?
(define –¥–∞–≤–ª–µ–Ω–∏–µ-–æ—Ç–≤–µ—Ç–∞ #t)   ; —Å–æ—Ü–∏–∞–ª—å–Ω–æ–µ/—Ä–∞–º–æ—á–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ "–Ω–∞–¥–æ –∑–Ω–∞—Ç—å"
(define —Å–≤—è–∑–∞–Ω–∞-—Å-–∫–ª—é—á–µ–≤—ã–º–∏-—É–±–µ–∂–¥–µ–Ω–∏—è–º–∏? #t)  ; —Ç–µ–º–∞ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —Å–º—ã—Å–ª—ã



(define (–æ–±—Ä–∞–±–æ—Ç–∫–∞-–ø—É—Å—Ç–æ—Ç—ã)
  (cond
    ;; 1. –¢–µ–º–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞ + —Ç—Ä–µ–≤–æ–≥–∞ ‚Üí –≤—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∑–∞–º–µ—â–µ–Ω–∏—è
    [(and —Å–≤—è–∑–∞–Ω–∞-—Å-–∫–ª—é—á–µ–≤—ã–º–∏-—É–±–µ–∂–¥–µ–Ω–∏—è–º–∏? —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å)
     '–∑–∞–º–µ—â–µ–Ω–∏–µ-–∏–ª–ª—é–∑–∏–µ–π]

    ;; 2. –î–∞–≤–ª–µ–Ω–∏–µ + –Ω–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å–∞ ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ/—à—Ç–∞–º–ø
    [(and –¥–∞–≤–ª–µ–Ω–∏–µ-–æ—Ç–≤–µ—Ç–∞ (eq? –∏–Ω—Ç–µ—Ä–µ—Å #f))
     '—Ä–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è]

    ;; 3. –ò–Ω—Ç–µ—Ä–µ—Å + —Ç—Ä–µ–≤–æ–≥–∞ ‚Üí –≤–æ–∑–º–æ–∂–Ω–æ –Ω–∞—á–∞–ª–æ –ø–æ–∏—Å–∫–∞
    [(and –∏–Ω—Ç–µ—Ä–µ—Å —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å)
     '–∏–Ω–∏—Ü–∏–∞—Ü–∏—è-–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è]

    ;; 4. –ï—Å—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å, –Ω–æ –Ω–µ—Ç —Ç—Ä–µ–≤–æ–≥–∏ ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ, –æ—Ç—Å—Ä–æ—á–µ–Ω–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ
    [(and –∏–Ω—Ç–µ—Ä–µ—Å (eq? —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å #f))
     '—Å–ø–æ–∫–æ–π–Ω–æ–µ-–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ]

    ;; 5. –ù–µ—Ç –Ω–∏ —Ç—Ä–µ–≤–æ–≥–∏, –Ω–∏ –∏–Ω—Ç–µ—Ä–µ—Å–∞ ‚Üí –ø—É—Å—Ç–æ—Ç–∞ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
    [else '–ø–∞—Å—Å–∏–≤–Ω–æ–µ-–Ω–µ–∑–Ω–∞–Ω–∏–µ]))


; ‚úÖ –ü—Ä–∏–º–µ—Ä 1: –∞–∫—Ç–∏–≤–Ω–æ–µ –Ω–µ–∑–Ω–∞–Ω–∏–µ ‚Üí –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç—Å—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ
(–æ–±—Ä–∞–±–æ—Ç–∫–∞-–ø—É—Å—Ç–æ—Ç—ã
  #t     ; —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å –µ—Å—Ç—å
  #t     ; –∏–Ω—Ç–µ—Ä–µ—Å –µ—Å—Ç—å
  #f     ; –≤–Ω–µ—à–Ω–µ–≥–æ –¥–∞–≤–ª–µ–Ω–∏—è –Ω–µ—Ç
  #f)    ; –Ω–µ —Å–≤—è–∑–∞–Ω–æ —Å –∫–ª—é—á–µ–≤—ã–º–∏ —É–±–µ–∂–¥–µ–Ω–∏—è–º–∏
;; ‚Üí '–∏–Ω–∏—Ü–∏–∞—Ü–∏—è-–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è


; ‚ùå –ü—Ä–∏–º–µ—Ä 2: –∑–∞–º–µ—â–µ–Ω–∏–µ –∏–ª–ª—é–∑–∏–µ–π (–≤–µ—Ä–∞ + —Ç—Ä–µ–≤–æ–≥–∞)
(–æ–±—Ä–∞–±–æ—Ç–∫–∞-–ø—É—Å—Ç–æ—Ç—ã
  #t     ; —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å
  #f     ; –∏–Ω—Ç–µ—Ä–µ—Å–∞ –Ω–µ—Ç
  #t     ; –¥–∞–≤–ª–µ–Ω–∏–µ ¬´–Ω–∞–¥–æ –∑–Ω–∞—Ç—å¬ª
  #t)    ; —Å–≤—è–∑–∞–Ω–æ —Å –∫–ª—é—á–µ–≤—ã–º–∏ —É–±–µ–∂–¥–µ–Ω–∏—è–º–∏
;; ‚Üí '–∑–∞–º–µ—â–µ–Ω–∏–µ-–∏–ª–ª—é–∑–∏–µ–π


; üòê –ü—Ä–∏–º–µ—Ä 3: –ø–∞—Å—Å–∏–≤–Ω–æ–µ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ
(–æ–±—Ä–∞–±–æ—Ç–∫–∞-–ø—É—Å—Ç–æ—Ç—ã
  #f     ; –Ω–µ—Ç —Ç—Ä–µ–≤–æ–≥–∏
  #f     ; –Ω–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å–∞
  #f     ; –Ω–µ—Ç –¥–∞–≤–ª–µ–Ω–∏—è
  #f)    ; –Ω–µ–∑–Ω–∞—á–∏–º–∞—è —Ç–µ–º–∞
;; ‚Üí '–ø–∞—Å—Å–∏–≤–Ω–æ–µ-–Ω–µ–∑–Ω–∞–Ω–∏–µ


; üåÄ –ü—Ä–∏–º–µ—Ä 4: —Ä–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥ –¥–∞–≤–ª–µ–Ω–∏–µ–º
(–æ–±—Ä–∞–±–æ—Ç–∫–∞-–ø—É—Å—Ç–æ—Ç—ã
  #f     ; —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç–∏ –Ω–µ—Ç
  #f     ; –∏–Ω—Ç–µ—Ä–µ—Å–∞ –Ω–µ—Ç
  #t     ; –¥–∞–≤–ª–µ–Ω–∏–µ –µ—Å—Ç—å (—Å–æ—Ü. –∏–ª–∏ –ø—Ä–æ—Ñ.)
  #f)    ; –Ω–µ —Å–≤—è–∑–∞–Ω–æ —Å —É–±–µ–∂–¥–µ–Ω–∏—è–º–∏
;; ‚Üí '—Ä–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è




























