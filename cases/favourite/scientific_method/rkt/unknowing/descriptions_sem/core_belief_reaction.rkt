#lang racket

;; * ----------- üß≠ –ú–æ–¥–µ–ª—å: –ö–ª—é—á–µ–≤—ã–µ —É–±–µ–∂–¥–µ–Ω–∏—è (core-belief-reaction)

;; üß≠ –ú–æ–¥–µ–ª—å: –∫–∞–∫ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –∞–≥–µ–Ω—Ç, –µ—Å–ª–∏ –Ω–µ–∑–Ω–∞–Ω–∏–µ –∫–∞—Å–∞–µ—Ç—Å—è –∫–ª—é—á–µ–≤–æ–≥–æ —É–±–µ–∂–¥–µ–Ω–∏—è

(define (—Ä–µ–∞–∫—Ü–∏—è-–Ω–∞-–Ω–µ–∑–Ω–∞–Ω–∏–µ-–≤-–æ–ø–æ—Ä–µ —Å–≤—è–∑–∞–Ω–∞-—Å-—É–±–µ–∂–¥–µ–Ω–∏—è–º–∏? —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å?)
  (cond
    ;; 1. –£–±–µ–∂–¥–µ–Ω–∏–µ + —Ç—Ä–µ–≤–æ–≥–∞ + –Ω–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å–∞ ‚Üí –≤—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∑–∞–º–µ—â–µ–Ω–∏—è
    [(and —Å–≤—è–∑–∞–Ω–∞-—Å-—É–±–µ–∂–¥–µ–Ω–∏—è–º–∏? —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å (not –∏–Ω—Ç–µ—Ä–µ—Å?))
     '–∑–∞–º–µ—â–µ–Ω–∏–µ-–¥–æ–≥–º–æ–π]

    ;; 2. –£–±–µ–∂–¥–µ–Ω–∏–µ + —Ç—Ä–µ–≤–æ–≥–∞ + –µ—Å—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å ‚Üí —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ
    [(and —Å–≤—è–∑–∞–Ω–∞-—Å-—É–±–µ–∂–¥–µ–Ω–∏—è–º–∏? —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å?)
     '–ø—Ä–µ–¥–≤–∑—è—Ç–æ–µ-–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ]

    ;; 3. –£–±–µ–∂–¥–µ–Ω–∏–µ + –Ω–µ—Ç —Ç—Ä–µ–≤–æ–≥–∏ ‚Üí –≤—ã—Ç–µ—Å–Ω–µ–Ω–∏–µ –∏–ª–∏ –æ—Ç—Å—Ä–æ—á–∫–∞
    [(and —Å–≤—è–∑–∞–Ω–∞-—Å-—É–±–µ–∂–¥–µ–Ω–∏—è–º–∏? (not —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å))
     '–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ-–±–æ–ª–µ–≤–æ–π-—Ç–æ—á–∫–∏]

    ;; 4. –ù–µ —Å–≤—è–∑–∞–Ω–æ —Å —É–±–µ–∂–¥–µ–Ω–∏–µ–º ‚Üí –æ–±—ã—á–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è
    [else '–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ-–æ—Ç–Ω–æ—à–µ–Ω–∏–µ]))



; ‚úÖ –ü—Ä–∏–º–µ—Ä—ã –≤—ã–∑–æ–≤–∞:

; üí£ –ü—Ä–∏–º–µ—Ä 1: –Ω–µ–∑–Ω–∞–Ω–∏–µ –ø—Ä–æ "—Å–º—ã—Å–ª –∂–∏–∑–Ω–∏", —Ç—Ä–µ–≤–æ–≥–∞, –Ω–æ –Ω–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å–∞
(—Ä–µ–∞–∫—Ü–∏—è-–Ω–∞-–Ω–µ–∑–Ω–∞–Ω–∏–µ-–≤-–æ–ø–æ—Ä–µ #t #t #f)
;; ‚Üí '–∑–∞–º–µ—â–µ–Ω–∏–µ-–¥–æ–≥–º–æ–π

; üåÄ –ü—Ä–∏–º–µ—Ä 2: –Ω–µ–∑–Ω–∞–Ω–∏–µ –≤ –≤–∞–∂–Ω–æ–π —Ç–µ–º–µ, –µ—Å—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å, –Ω–æ —Ç—Ä–µ–≤–æ–∂–Ω–æ
(—Ä–µ–∞–∫—Ü–∏—è-–Ω–∞-–Ω–µ–∑–Ω–∞–Ω–∏–µ-–≤-–æ–ø–æ—Ä–µ #t #t #t)
;; ‚Üí '–ø—Ä–µ–¥–≤–∑—è—Ç–æ–µ-–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ

; üßä –ü—Ä–∏–º–µ—Ä 3: —á–µ–ª–æ–≤–µ–∫ –∑–Ω–∞–µ—Ç, —á—Ç–æ —Ç–µ–º–∞ –≤–∞–∂–Ω–∞, –Ω–æ —Ç—Ä–µ–≤–æ–≥–∏ –Ω–µ—Ç
(—Ä–µ–∞–∫—Ü–∏—è-–Ω–∞-–Ω–µ–∑–Ω–∞–Ω–∏–µ-–≤-–æ–ø–æ—Ä–µ #t #f #t)
;; ‚Üí '–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ-–±–æ–ª–µ–≤–æ–π-—Ç–æ—á–∫–∏

; ‚úÖ –ü—Ä–∏–º–µ—Ä 4: –æ–±—ã—á–Ω–∞—è —Ç–µ–º–∞, –Ω–µ –æ–ø–æ—Ä–∞
(—Ä–µ–∞–∫—Ü–∏—è-–Ω–∞-–Ω–µ–∑–Ω–∞–Ω–∏–µ-–≤-–æ–ø–æ—Ä–µ #f #t #t)
;; ‚Üí '–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ-–æ—Ç–Ω–æ—à–µ–Ω–∏–µ