#lang racket


;; * ----------- üîß –ú–æ–¥–µ–ª—å –¥–∞–≤–ª–µ–Ω–∏—è-–æ—Ç–≤–µ—Ç–∞ 

;; –î–∞–≤–ª–µ–Ω–∏–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Ä–æ–ª–∏, –∫—É–ª—å—Ç—É—Ä—ã –∏–ª–∏ –ª–∏—á–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è
;; –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –æ—Ç–≤–µ—Ç –¥–∞–∂–µ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∏–Ω—Ç–µ—Ä–µ—Å–∞ –∫ —Ç–µ–º–µ.


(define –∏—Å—Ç–æ—á–Ω–∏–∫–∏-–¥–∞–≤–ª–µ–Ω–∏—è
  (list
   (list (cons '–∫–∞—Ç–µ–≥–æ—Ä–∏—è '—Ä–æ–ª–µ–≤–∞—è-–æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç—å)
         (cons '–ø—Ä–∏–º–µ—Ä—ã (list
                         '—É—á–∏—Ç–µ–ª—å-–¥–æ–ª–∂–µ–Ω-–∑–Ω–∞—Ç—å
                         '—Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å-–æ–±—è–∑–∞–Ω-–æ—Ç–≤–µ—á–∞—Ç—å
                         '—Ä–æ–¥–∏—Ç–µ–ª—å-–¥–æ–ª–∂–µ–Ω-–æ–±—ä—è—Å–Ω–∏—Ç—å)))

   (list (cons '–∫–∞—Ç–µ–≥–æ—Ä–∏—è '–∫—É–ª—å—Ç—É—Ä–Ω—ã–π-–∫–æ–Ω—Ç–µ–∫—Å—Ç)
         (cons '–ø—Ä–∏–º–µ—Ä—ã (list
                         '–∫—É–ª—å—Ç—É—Ä–∞-—É—Å–ø–µ—Ö–∞
                         '–ø—Ä–µ–∑—Ä–µ–Ω–∏–µ-–∫-–Ω–µ–∑–Ω–∞–Ω–∏—é
                         '–±–∏–∑–Ω–µ—Å-–Ω–µ-–¥–æ–ø—É—Å–∫–∞–µ—Ç-—Å–æ–º–Ω–µ–Ω–∏–π)))

   (list (cons '–∫–∞—Ç–µ–≥–æ—Ä–∏—è '–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ-—É–±–µ–∂–¥–µ–Ω–∏—è)
         (cons '–ø—Ä–∏–º–µ—Ä—ã (list
                         '—Å—Ç—ã–¥-–ø—Ä–∏–∑–Ω–∞—Ç—å—Å—è
                         '–∑–∞–ø—Ä–µ—Ç-–Ω–∞-–ø—Ä–æ–±–µ–ª—ã
                         '–æ–±—è–∑–∞–Ω-–∫–∞–∑–∞—Ç—å—Å—è-–∫–æ–º–ø–µ—Ç–µ–Ω—Ç–Ω—ã–º)))

   (list (cons '–∫–∞—Ç–µ–≥–æ—Ä–∏—è '—Å–∏—Ç—É–∞—Ç–∏–≤–Ω–æ–µ-–¥–∞–≤–ª–µ–Ω–∏–µ)
         (cons '–ø—Ä–∏–º–µ—Ä—ã (list
                         '–∫—Ä–∏–∑–∏—Å-–Ω—É–∂–µ–Ω-–æ—Ç–≤–µ—Ç
                         '–ø—É–±–ª–∏—á–Ω–æ—Å—Ç—å-–≤—ã–∑—ã–≤–∞–µ—Ç-—Å—Ç—Ä–∞—Ö
                         '–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è-–ø–æ–∑–∏—Ü–∏—è-–≤-–≥—Ä—É–ø–ø–µ)))

   (list (cons '–∫–∞—Ç–µ–≥–æ—Ä–∏—è '–∫–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω–æ–µ-–Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ)
         (cons '–ø—Ä–∏–º–µ—Ä—ã (list
                         '–ø—Ä–æ–≤–æ–∫–∞—Ü–∏–æ–Ω–Ω—ã–π-–≤–æ–ø—Ä–æ—Å
                         '–º–∞–Ω–∏–ø—É–ª—è—Ç–∏–≤–Ω–æ–µ-–¥–∞–≤–ª–µ–Ω–∏–µ
                         '–≤–∑–≥–ª—è–¥-–∞—É–¥–∏—Ç–æ—Ä–∏–∏)))

   (list (cons '–∫–∞—Ç–µ–≥–æ—Ä–∏—è '—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è-—Ä–µ–∞–∫—Ü–∏—è)
         (cons '–ø—Ä–∏–º–µ—Ä—ã (list
                         '—Ç—Ä–µ–≤–æ–≥–∞-–ø–µ—Ä–µ–¥-–ø—É—Å—Ç–æ—Ç–æ–π
                         '—Å—Ç—Ä–∞—Ö-–≤—ã–≥–ª—è–¥–µ—Ç—å-–≥–ª—É–ø–æ
                         '—á—É–≤—Å—Ç–≤–æ-–Ω–µ–∞–¥–µ–∫–≤–∞—Ç–Ω–æ—Å—Ç–∏)))

   (list (cons '–∫–∞—Ç–µ–≥–æ—Ä–∏—è '–∏–¥–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ-—Ä–∞–º–∫–∏)
         (cons '–ø—Ä–∏–º–µ—Ä—ã (list
                         '–Ω–µ–ª—å–∑—è-–ø—Ä–µ–¥–∞—Ç—å-–¥–æ–∫—Ç—Ä–∏–Ω—É
                         '—Å–æ–æ–±—â–µ—Å—Ç–≤–æ-–Ω–∞–∫–∞–∑—ã–≤–∞–µ—Ç-—Å–æ–º–Ω–µ–Ω–∏–µ
                         '–∂–µ—Å—Ç–∫–∞—è-–ø–æ–∑–∏—Ü–∏—è-—à–∫–æ–ª—ã)))
   ))








(define (–¥–∞–≤–ª–µ–Ω–∏–µ-–æ—Ç–≤–µ—Ç–∞? —Ä–æ–ª—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–Ω—Ç–µ—Ä–µ—Å?)
  (cond
    ;; –ï—Å–ª–∏ —Ä–æ–ª—å —Ç—Ä–µ–±—É–µ—Ç –∫–æ–º–ø–µ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –∏ –∏–Ω—Ç–µ—Ä–µ—Å–∞ –Ω–µ—Ç ‚Üí –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –¥–∞–≤–ª–µ–Ω–∏–µ
    [(and (member —Ä–æ–ª—å '(—É—á–∏—Ç–µ–ª—å —ç–∫—Å–ø–µ—Ä—Ç —Ä–æ–¥–∏—Ç–µ–ª—å)) (not –∏–Ω—Ç–µ—Ä–µ—Å?))
     '—Å–æ—Ü–∏–∞–ª—å–Ω–∞—è-–æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç—å]

    ;; –ï—Å–ª–∏ –∫—É–ª—å—Ç—É—Ä–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç –Ω–µ–∑–Ω–∞–Ω–∏—è ‚Üí –¥–∞–≤–ª–µ–Ω–∏–µ
    [(member –∫–æ–Ω—Ç–µ–∫—Å—Ç '(–∫—É–ª—å—Ç—É—Ä–∞-–∑–Ω–∞–Ω–∏—è —ç–ª–∏—Ç–∏–∑–º –ø–µ—Ä—Ñ–µ–∫—Ü–∏–æ–Ω–∏–∑–º))
     '–∫—É–ª—å—Ç—É—Ä–Ω—ã–π-–∏–º–ø–µ—Ä–∞—Ç–∏–≤]

    ;; –í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —É–±–µ–∂–¥–µ–Ω–∏–µ ¬´–Ω–µ–ª—å–∑—è –Ω–µ –∑–Ω–∞—Ç—å¬ª –±–µ–∑ –∏–Ω—Ç–µ—Ä–µ—Å–∞ ‚Üí –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ
    [(not –∏–Ω—Ç–µ—Ä–µ—Å?)
     '–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π-—à—Ç–∞–º–ø]

    ;; –í –¥—Ä—É–≥–∏—Ö —Å–ª—É—á–∞—è—Ö ‚Äî –¥–∞–≤–ª–µ–Ω–∏—è –Ω–µ—Ç
    [else '–Ω–µ—Ç-–¥–∞–≤–ª–µ–Ω–∏—è]))



;; üö¶ –ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–µ —Å–ª–µ–¥—Å—Ç–≤–∏–µ –¥–∞–≤–ª–µ–Ω–∏—è-–æ—Ç–≤–µ—Ç–∞
(define (—Ä–µ–∞–∫—Ü–∏—è-–Ω–∞-–¥–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–ø-–¥–∞–≤–ª–µ–Ω–∏—è)
  (cond
    [(eq? —Ç–∏–ø-–¥–∞–≤–ª–µ–Ω–∏—è '—Å–æ—Ü–∏–∞–ª—å–Ω–∞—è-–æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç—å)
     '—Ä–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è-–ø–æ–¥-—Ä–æ–ª–µ–≤–æ–µ-–æ–∂–∏–¥–∞–Ω–∏–µ]

    [(eq? —Ç–∏–ø-–¥–∞–≤–ª–µ–Ω–∏—è '–∫—É–ª—å—Ç—É—Ä–Ω—ã–π-–∏–º–ø–µ—Ä–∞—Ç–∏–≤)
     '—à—Ç–∞–º–ø–æ–≤–∞–Ω–Ω–æ–µ-–æ–±—ä—è—Å–Ω–µ–Ω–∏–µ]

    [(eq? —Ç–∏–ø-–¥–∞–≤–ª–µ–Ω–∏—è '–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π-—à—Ç–∞–º–ø)
     '–º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ-–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ-–ø—É—Å—Ç–æ—Ç—ã]

    [else '–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ-–ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏–µ-–Ω–µ–∑–Ω–∞–Ω–∏—è]))



; üéì –ü—Ä–∏–º–µ—Ä 1: —É—á–∏—Ç–µ–ª—å –±–µ–∑ –∏–Ω—Ç–µ—Ä–µ—Å–∞ –∫ —Ç–µ–º–µ
(—Ä–µ–∞–∫—Ü–∏—è-–Ω–∞-–¥–∞–≤–ª–µ–Ω–∏–µ
  (–¥–∞–≤–ª–µ–Ω–∏–µ-–æ—Ç–≤–µ—Ç–∞? '—É—á–∏—Ç–µ–ª—å '–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π-–∫–æ–Ω—Ç–µ–∫—Å—Ç #f))
;; ‚Üí '—Ä–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è-–ø–æ–¥-—Ä–æ–ª–µ–≤–æ–µ-–æ–∂–∏–¥–∞–Ω–∏–µ

; üìö –ü—Ä–∏–º–µ—Ä 2: –æ–±—ã—á–Ω—ã–π —á–µ–ª–æ–≤–µ–∫, –Ω–æ –≤ –∫—É–ª—å—Ç—É—Ä–µ —ç–ª–∏—Ç–∏–∑–º–∞
(—Ä–µ–∞–∫—Ü–∏—è-–Ω–∞-–¥–∞–≤–ª–µ–Ω–∏–µ
  (–¥–∞–≤–ª–µ–Ω–∏–µ-–æ—Ç–≤–µ—Ç–∞? '–≥–æ—Å—Ç—å '—ç–ª–∏—Ç–∏–∑–º #f))
;; ‚Üí '—à—Ç–∞–º–ø–æ–≤–∞–Ω–Ω–æ–µ-–æ–±—ä—è—Å–Ω–µ–Ω–∏–µ

; üßò –ü—Ä–∏–º–µ—Ä 3: –Ω–µ—Ç —Ä–æ–ª–∏, –Ω–µ—Ç –¥–∞–≤–ª–µ–Ω–∏—è, –µ—Å—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å
(—Ä–µ–∞–∫—Ü–∏—è-–Ω–∞-–¥–∞–≤–ª–µ–Ω–∏–µ
  (–¥–∞–≤–ª–µ–Ω–∏–µ-–æ—Ç–≤–µ—Ç–∞? '–Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å '–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π #t))
;; ‚Üí '–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ-–ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏–µ-–Ω–µ–∑–Ω–∞–Ω–∏—è
