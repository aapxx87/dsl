#lang racket

;; * ----------- üîß –ú–æ–¥–µ–ª—å –¥–∞–≤–ª–µ–Ω–∏—è-–æ—Ç–≤–µ—Ç–∞ 

;; –î–∞–≤–ª–µ–Ω–∏–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Ä–æ–ª–∏, –∫—É–ª—å—Ç—É—Ä—ã –∏–ª–∏ –ª–∏—á–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è
;; –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –æ—Ç–≤–µ—Ç –¥–∞–∂–µ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∏–Ω—Ç–µ—Ä–µ—Å–∞ –∫ —Ç–µ–º–µ.

(define (–¥–∞–≤–ª–µ–Ω–∏–µ-–æ—Ç–≤–µ—Ç–∞? —Ä–æ–ª—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–Ω—Ç–µ—Ä–µ—Å?)
  (cond
    ;; –ï—Å–ª–∏ —Ä–æ–ª—å —Ç—Ä–µ–±—É–µ—Ç –∫–æ–º–ø–µ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –∏ –∏–Ω—Ç–µ—Ä–µ—Å–∞ –Ω–µ—Ç ‚Üí –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –¥–∞–≤–ª–µ–Ω–∏–µ
    [(and (member —Ä–æ–ª—å '(—É—á–∏—Ç–µ–ª—å —ç–∫—Å–ø–µ—Ä—Ç —Ä–æ–¥–∏—Ç–µ–ª—å)) (not –∏–Ω—Ç–µ—Ä–µ—Å?))
     '—Å–æ—Ü–∏–∞–ª—å–Ω–∞—è-–æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç—å]

    ;; –ï—Å–ª–∏ –∫—É–ª—å—Ç—É—Ä–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç –Ω–µ–∑–Ω–∞–Ω–∏—è ‚Üí –¥–∞–≤–ª–µ–Ω–∏–µ
    [(member –∫–æ–Ω—Ç–µ–∫—Å—Ç '(–∫—É–ª—å—Ç—É—Ä–∞-–∑–Ω–∞–Ω–∏—è —ç–ª–∏—Ç–∏–∑–º –ø–µ—Ä—Ñ–µ–∫—Ü–∏–æ–Ω–∏–∑–º))
     '–∫—É–ª—å—Ç—É—Ä–Ω—ã–π-–∏–º–ø–µ—Ä–∞—Ç–∏–≤]

    ;; –í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —É–±–µ–∂–¥–µ–Ω–∏–µ ¬´–Ω–µ–ª—å–∑—è –Ω–µ –∑–Ω–∞—Ç—å¬ª –±–µ–∑ –∏–Ω—Ç–µ—Ä–µ—Å–∞ ‚Üí –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ
    [(not –∏–Ω—Ç–µ—Ä–µ—Å?)
     '–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π-—à—Ç–∞–º–ø]

    ;; –í –¥—Ä—É–≥–∏—Ö —Å–ª—É—á–∞—è—Ö ‚Äî –¥–∞–≤–ª–µ–Ω–∏—è –Ω–µ—Ç
    [else '–Ω–µ—Ç-–¥–∞–≤–ª–µ–Ω–∏—è]))



;; üö¶ –ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–µ —Å–ª–µ–¥—Å—Ç–≤–∏–µ –¥–∞–≤–ª–µ–Ω–∏—è-–æ—Ç–≤–µ—Ç–∞
(define (—Ä–µ–∞–∫—Ü–∏—è-–Ω–∞-–¥–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–ø-–¥–∞–≤–ª–µ–Ω–∏—è)
  (cond
    [(eq? —Ç–∏–ø-–¥–∞–≤–ª–µ–Ω–∏—è '—Å–æ—Ü–∏–∞–ª—å–Ω–∞—è-–æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç—å)
     '—Ä–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è-–ø–æ–¥-—Ä–æ–ª–µ–≤–æ–µ-–æ–∂–∏–¥–∞–Ω–∏–µ]

    [(eq? —Ç–∏–ø-–¥–∞–≤–ª–µ–Ω–∏—è '–∫—É–ª—å—Ç—É—Ä–Ω—ã–π-–∏–º–ø–µ—Ä–∞—Ç–∏–≤)
     '—à—Ç–∞–º–ø–æ–≤–∞–Ω–Ω–æ–µ-–æ–±—ä—è—Å–Ω–µ–Ω–∏–µ]

    [(eq? —Ç–∏–ø-–¥–∞–≤–ª–µ–Ω–∏—è '–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π-—à—Ç–∞–º–ø)
     '–º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ-–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ-–ø—É—Å—Ç–æ—Ç—ã]

    [else '–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ-–ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏–µ-–Ω–µ–∑–Ω–∞–Ω–∏—è]))



; üéì –ü—Ä–∏–º–µ—Ä 1: —É—á–∏—Ç–µ–ª—å –±–µ–∑ –∏–Ω—Ç–µ—Ä–µ—Å–∞ –∫ —Ç–µ–º–µ
(—Ä–µ–∞–∫—Ü–∏—è-–Ω–∞-–¥–∞–≤–ª–µ–Ω–∏–µ
  (–¥–∞–≤–ª–µ–Ω–∏–µ-–æ—Ç–≤–µ—Ç–∞? '—É—á–∏—Ç–µ–ª—å '–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π-–∫–æ–Ω—Ç–µ–∫—Å—Ç #f))
;; ‚Üí '—Ä–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è-–ø–æ–¥-—Ä–æ–ª–µ–≤–æ–µ-–æ–∂–∏–¥–∞–Ω–∏–µ

; üìö –ü—Ä–∏–º–µ—Ä 2: –æ–±—ã—á–Ω—ã–π —á–µ–ª–æ–≤–µ–∫, –Ω–æ –≤ –∫—É–ª—å—Ç—É—Ä–µ —ç–ª–∏—Ç–∏–∑–º–∞
(—Ä–µ–∞–∫—Ü–∏—è-–Ω–∞-–¥–∞–≤–ª–µ–Ω–∏–µ
  (–¥–∞–≤–ª–µ–Ω–∏–µ-–æ—Ç–≤–µ—Ç–∞? '–≥–æ—Å—Ç—å '—ç–ª–∏—Ç–∏–∑–º #f))
;; ‚Üí '—à—Ç–∞–º–ø–æ–≤–∞–Ω–Ω–æ–µ-–æ–±—ä—è—Å–Ω–µ–Ω–∏–µ

; üßò –ü—Ä–∏–º–µ—Ä 3: –Ω–µ—Ç —Ä–æ–ª–∏, –Ω–µ—Ç –¥–∞–≤–ª–µ–Ω–∏—è, –µ—Å—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å
(—Ä–µ–∞–∫—Ü–∏—è-–Ω–∞-–¥–∞–≤–ª–µ–Ω–∏–µ
  (–¥–∞–≤–ª–µ–Ω–∏–µ-–æ—Ç–≤–µ—Ç–∞? '–Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å '–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π #t))
;; ‚Üí '–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ-–ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏–µ-–Ω–µ–∑–Ω–∞–Ω–∏—è
