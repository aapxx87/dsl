#lang racket


; ÐžÑ‚Ð»Ð¸Ñ‡Ð½Ð¾!
; Ð¢Ñ‹ Ñ…Ð¾Ñ‡ÐµÑˆÑŒ Ð½Ðµ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Â«Ñ€ÐµÑ„Ñ€ÐµÐ¹Ð¼Ð¸Ð½Ð³ â€” Ð´Ð°/Ð½ÐµÑ‚Â», Ð° Ð¼Ð¾Ð´ÐµÐ»ÑŒ, Ñ‡ÑƒÐ²ÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½ÑƒÑŽ Ðº Ñ‚Ð¸Ð¿Ñƒ ÑÐ¸Ð³Ð½Ð°Ð»Ð°, Ñ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒÑŽ:
; 	â€¢	Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð°Ñ‚ÑŒ, Ð¿Ð¾Ñ‡ÐµÐ¼Ñƒ Ñ€Ð°Ð¼ÐºÐ° Ð±Ð¾Ð»ÑŒÑˆÐµ Ð½Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚;
; 	â€¢	Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ ÑÑ‚Ð¾ ÐºÐ°Ðº Ð¾ÑÐ½Ð¾Ð²Ñƒ Ð´Ð»Ñ Ñ€Ð°Ð·Ð½Ñ‹Ñ… ÑÑ‚Ñ€Ð°Ñ‚ÐµÐ³Ð¸Ð¹ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð°: Ð¼ÑÐ³ÐºÐ¸Ð¹, ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹, Ñ‡ÐµÑ€ÐµÐ· ÐºÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚ Ð¸ Ñ‚.Ð´.

; Ð”Ð°Ð²Ð°Ð¹ ÑˆÐ°Ð³ Ð·Ð° ÑˆÐ°Ð³Ð¾Ð¼ Ð¿Ð¾ÑÑ‚Ñ€Ð¾Ð¸Ð¼ ÑÑ‚Ð¾ Ð² Ð¿Ð¾Ð½ÑÑ‚Ð½Ð¾Ð¼ Ñ‚ÐµÐ±Ðµ ÑÑ‚Ð¸Ð»Ðµ â€” Ð±ÐµÐ· lambda, Ñ define, cond, if.

; â¸»

; âœ… 1. Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð¸Ñ€ÑƒÐµÐ¼: Ñ‚Ñ€Ð¸ Ñ‚Ð¸Ð¿Ð° ÑÐ¸Ð³Ð½Ð°Ð»Ð¾Ð²

;; Ð¢Ð¸Ð¿ 1: Ð²Ð½ÑƒÑ‚Ñ€ÐµÐ½Ð½ÑÑ Ð³Ð»Ð°Ð´ÐºÐ¾ÑÑ‚ÑŒ â€” Ð¿Ñ€Ð¸Ð·Ð½Ð°Ðº ÑÑ‚Ð°Ð³Ð½Ð°Ñ†Ð¸Ð¸
(define Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð²-1 0) ; Ð½ÐµÑ‚ Ð½Ð¾Ð²Ñ‹Ñ… Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð²
(define Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÑÐµÐ¼Ð¾ÑÑ‚ÑŒ #t) ; Ð²ÑÑ‘ Ð·Ð²ÑƒÑ‡Ð¸Ñ‚ Ð·Ð½Ð°ÐºÐ¾Ð¼Ð¾
(define ÐºÑ€ÑƒÑ‚Ð¸Ñ‚ÑÑ-Ð¿Ð¾-ÐºÑ€ÑƒÐ³Ñƒ #t)

;; Ð¢Ð¸Ð¿ 2: Ð¾Ñ‚ÐºÐ°Ð· Ð¼Ð¾Ð´ÐµÐ»Ð¸ â€” ÑÐ±Ð¾Ð¸ Ð² Ð¾Ð±ÑŠÑÑÐ½ÐµÐ½Ð¸Ð¸
(define Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ-2 3)
(define Ñ€Ð°Ñ†Ð¸Ð¾Ð½Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ #t)
(define Ð¿ÐµÑ€ÐµÐ½Ð¾Ñ-Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼ #t)

;; Ð¢Ð¸Ð¿ 3: ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚ Ñ Ð´Ñ€ÑƒÐ³Ð¸Ð¼ Ð²Ð¸Ð´ÐµÐ½Ð¸ÐµÐ¼ â€” ÐºÐ¾Ð³Ð½Ð¸Ñ‚Ð¸Ð²Ð½Ð¾Ðµ Ñ‚Ñ€ÐµÐ½Ð¸Ðµ
(define Ð½ÐµÑƒÑŽÑ‚Ð½Ð¾ÑÑ‚ÑŒ #t)
(define ÑÑ„Ñ„ÐµÐºÑ‚-ÑƒÐ·Ð½Ð°Ð²Ð°Ð½Ð¸Ñ #t)
(define Ð·Ð°Ñ‰Ð¸Ñ‚Ð°-Ñ€Ð°Ð¼ÐºÐ¸ #t)


;  âœ… 2. Ð¢Ñ€Ð¸ Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸


;; ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð° Ð²Ð½ÑƒÑ‚Ñ€ÐµÐ½Ð½ÑŽÑŽ Ð³Ð»Ð°Ð´ÐºÐ¾ÑÑ‚ÑŒ
(define (reframe-Ð³Ð»Ð°Ð´ÐºÐ¾ÑÑ‚ÑŒ? Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð² Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÑÐµÑ‚ÑÑ ÐºÑ€ÑƒÐ³)
  (if (and (zero? Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð²) Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÑÐµÑ‚ÑÑ ÐºÑ€ÑƒÐ³)
      #t
      #f))

;; ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð° Ð¾Ñ‚ÐºÐ°Ð· Ð¼Ð¾Ð´ÐµÐ»Ð¸
(define (reframe-Ð¾Ñ‚ÐºÐ°Ð·? Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ñ€Ð°Ñ†Ð¸Ð¾Ð½Ð°Ð»Ð¸Ð· Ð¿ÐµÑ€ÐµÐ½Ð¾Ñ)
  (if (or (> Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ 2) Ñ€Ð°Ñ†Ð¸Ð¾Ð½Ð°Ð»Ð¸Ð· Ð¿ÐµÑ€ÐµÐ½Ð¾Ñ)
      #t
      #f))

;; ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð° ÐºÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚ Ñ Ð°Ð»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð¾Ð¹
(define (reframe-ÐºÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚? Ð½ÐµÑƒÑŽÑ‚Ð½Ð¾ ÑƒÐ·Ð½Ð°Ð²Ð°Ð½Ð¸Ðµ Ð·Ð°Ñ‰Ð¸Ñ‚Ð°)
  (if (or Ð½ÐµÑƒÑŽÑ‚Ð½Ð¾ ÑƒÐ·Ð½Ð°Ð²Ð°Ð½Ð¸Ðµ Ð·Ð°Ñ‰Ð¸Ñ‚Ð°)
      #t
      #f))


;  âœ… 2. Ð¢Ñ€Ð¸ Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸

(define (need-reframe? Ñ‚Ð¸Ð¿)
  (cond
    [(equal? Ñ‚Ð¸Ð¿ 'Ð³Ð»Ð°Ð´ÐºÐ¾ÑÑ‚ÑŒ)
     (reframe-Ð³Ð»Ð°Ð´ÐºÐ¾ÑÑ‚ÑŒ? Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð²-1 Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÑÐµÐ¼Ð¾ÑÑ‚ÑŒ ÐºÑ€ÑƒÑ‚Ð¸Ñ‚ÑÑ-Ð¿Ð¾-ÐºÑ€ÑƒÐ³Ñƒ)]
    
    [(equal? Ñ‚Ð¸Ð¿ 'Ð¾Ñ‚ÐºÐ°Ð·)
     (reframe-Ð¾Ñ‚ÐºÐ°Ð·? Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ-2 Ñ€Ð°Ñ†Ð¸Ð¾Ð½Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð¿ÐµÑ€ÐµÐ½Ð¾Ñ-Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼)]

    [(equal? Ñ‚Ð¸Ð¿ 'ÐºÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚)
     (reframe-ÐºÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚? Ð½ÐµÑƒÑŽÑ‚Ð½Ð¾ÑÑ‚ÑŒ ÑÑ„Ñ„ÐµÐºÑ‚-ÑƒÐ·Ð½Ð°Ð²Ð°Ð½Ð¸Ñ Ð·Ð°Ñ‰Ð¸Ñ‚Ð°-Ñ€Ð°Ð¼ÐºÐ¸)]

    [else
     #f]))

; ðŸ§ª ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ Ð²Ñ‹Ð·Ð¾Ð²Ð°

(need-reframe? 'Ð³Ð»Ð°Ð´ÐºÐ¾ÑÑ‚ÑŒ)  ; => #t
(need-reframe? 'Ð¾Ñ‚ÐºÐ°Ð·)      ; => #t
(need-reframe? 'ÐºÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚)   ; => #t